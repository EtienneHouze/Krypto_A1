import numpy as np
import matplotlib.pyplot as plt
from operator import itemgetter
from collections import OrderedDict

CIPHER_BASE = "TKCYXB7RK3SUMIGRXBD1UWOKIH6PY3WSE7S670XTUA0BIXZCF3KU5DWLW0_UEPVCIIWCDXCIRW_620DQEHS6DFK_AYC72K_YEI6OEEGFQWW1VIOHEE0QUQSTM5ZCIXZQ63SUXKBCIT61PAOP0ZKC7HCSQPGR30XGQHGFQQ7_MMCEZKCYGPE1AEZJIG6T_M56EISYXBFGEJ1RIPDJYVC15POAXNWP5OG7UF51ETO3U3ZJG0SR0KWLBFV1V1C7MPSYBPKV_N_C2UKCMLO1PWZG_FKOUJSY5P6TMPOIZK56IB5FEUSRIJKYUWCH_PGR30TNMISYEBC11XCGCWT6CMD15DORIXZK5W2U5DSY5FUWXEOPIDZCDQ1U_BGFUSKUUO7C70SHZS05Q7GKU0SPE3UPUFSD5IC6ZPSPBB_PYA0RIBKRUW1C_JGD3SKOQWC6A0WP_IX5QNSBIJ51TA5YVFWD5ICBQ35RIB5FEUSRIB31136B_HZWIC2CYAZCATKF1HCCEJ1RIF5E_Q56WFKJYVC6YK7G3OC1PERYY05QF3P6QHGAXBBOQ7G6B0DJAWOU5NAJG0YGZQWLU0WZBVOM3E1LA06HEJORCSW1ILS3TW7F3VYJE5ARIM_VFPOUYE5RXGENEE0Y7FSN1XAU3KGMVUWPE3_SAFV1GWC5U7GGIO6VEWPSB06JM_R15WWQINSPEPV6B0ZGMHKLQOGQ30DQE3QACTW10MWMQHTY1ZKFQ35YVS_G7HCCEL5M1JCGEU1SIJKY1PVUUI2P3WW1UWCG0MKPA3VIZCSPIBC1T36YUWWTMFO6ZW_WIISDUPGA3ODK7YOU5KGPCN_PMPSY3OKGHI0SELSRBZKXQTORYP51ILS3TWTM7UEPQW_6G0VKETOH3AGGIX_NXWSLZPI1FLOU0NSQUOD1MJRYBIW1BE1NEOV60MKDQWTM703GMXR6ELOQB05QE71SRUK_AYC12AGPYHZVEIEYRFCVMSPURNWC2EC15DSPU0GQGPNUNAGDQSKNQO6YAVXHYVSHSWOK3OYU5W_62L_PX3S7EISLI0SPPWUMT01PA_1UADEYBIW_E35CIT61ZE1BUK0CT0KFU7GL3UKG6TVICW7FUJB1UIOEYOSV1SXMEO1YQTCKPQ1SAMI11RCLQ6OJ0J5IEPVCINWOAVAU_BGNQTD13K5P3XKK7W26M7GMV0TGMNWLW0DJYM0U0NSQUOD1XK7YEJDJMI_OMJWKYUI1NAGIYOV1YRYOSDGR30_PRK5KINI16S2BQNGRXBD1UW6FQM21UX26Z7GR30ZG2WPSAJ5GEWCN_W7FU0TG3PGMV03_MELCXE7WIB5FEOV60MKI1ZOUTA5YBIW1Q35JYFCVMMX7_N_6BJ6PE3PMCUKKF3SUT3BCITWGZW_WIBEPF3KHPWTG2EKVT37YAIW11WCPQNEYVBB1RN1KICWK7KCNTAGBYTSI2AS6RMW1BI0M_JGMCSKH2ESLTTKC5POAQWVC70DQE5SYAIW11WC1EHWTUMI1ODSC7GENM_YGMJGUYUZ15DSYRFCVMSPUTAOPBTKKEADN0B_PYHCN_WVC703_EI1RXFBUM_0IZC6YEJDJENSEQSV1FSCNT37Y5BBVEKTYXFB1BS0NUK0YEI_ETWV6A0TGYRCQUPVFUMV1RN1KIIWTMWR6EP1JT03GEPVCIN6V1ZOME30BISWC3K0QIPX10I0U_S0YSP5F667YQOV1FLOU5A5KA06PESVGSIKU0ICC3WCG0M_PSW7MIH_XY33JEPVCIXZQXAG62EKVA3NIEI1PU0DJMJGUU0ZCHIC13GSBIJ513D1PB0_1WEXH_PGU7JDGEBAPBIWTMYZIZW7FYTKU65XCSUKCF3ZLQOSLB06PXUG6ATETY3WSEI1RXFB15DORIB2NM_SFXWUMIP51AAZJIB5FMMCBMRSYQHSKZW17AFBXYHCGCWRCQSKH2ESLT0_PMXRC3W7PYG2KZCG6VGSKD32BMPGKYTEPPA5QBB5F1RQME30BIOWIXAQRIPUEUWSIZW_M7FKOUOQFYFX11RCNTAGU3S2FEPV620WXYRCGMHWAU0SPPWCGSLWF7I1ME37YQM21QRSLBTKV0ICNAKGJQUDG2WOPU06HMPOM3WTPUREGZPGMSDETDIX3QWGG206VTA5Y7FCRYG2MEEG610FG2UGUUM21AJPUTA5CIT6NUPABU0_PMXRC3W7C7SWU5NW6007CDENC3AGGA0S1SA0GQMKDUPWU5KGKG03KZ7G62EKV0ICS_Q0EIT7TUJUYSIWGDWCQUPVYYUC1NKALBF6WE3ZL_IWQUTKOCW1DBF5V1QOMEIWQWJFKZCGFUBBVMI562UGR7FW1QRSPG0TWELCC3WTS0MKQRWTJ3XWTE3KHPW1LU03KSD7YEJCJMLSG3AZDIUBCZOTM7NWFMMXN_WOYRVDVQNTJG0DQMJVIMPG6RPEVEE0YBI_UMSM6MJGMV07G2BAKU0SPX3PCZ7GFYTKYTKZCIFHKEXOHOAGG20_VEW7FU0DQIRCC5OSJV0_UE7WQQHBGYELFQWPSB0DJQJG60MKCDS3HPWEMC0XKZ7G620_PY0ZLQO6GRMW1NAOSBZKQZ3X15Q5CIUZK3WWLTVUGX32BQWZ6BFKE_Q0RINKVA3V1CW1SB0S1S35BUOKQ73YHQW1DIUZGEOZM5J5IMLSFXOGUXJUJEDSPU0_PFI0MQ67YUBUJEK7FUSKY1XRU5DSY1PCVE6V67N_P_3512ESRG0SPPWTM7NKV0ICG_O7Y0PFGXUGTQM2GKWCNTAGEQSVGZWWQIT_OBPOUMJRYYUKK3WS6AZKVA3Z626SGDFKG7A0YCQ6PM1YO2WTG7TD1QJ7PQOUGMXR15W7FU07NMJGUQTKPAXC5QOWE2FV1NUG6ITUKYR2CREQYWBBFQJSPICEVMFAUMW_620GJ_WCGAIWFMXYUSEBCII_O3AZDIV710I06EP1YBIW1QJXMGNWPF3Y7EDWQIPGPEOSLAJDKHICBQ35RINSPCWOYBFSTMLKPQWWYQMBGM7EYAIWFMXYU5DSY1F3Q2UGMV0_VE3N6035RUEKOMO7C70_PMECM6I_C70ZQ6OSYEI_E03SMEJ1UISWF66SBIU61DYSH3WPSB0GC3WVGA0XCHS3LUPSY7FCQ2PG62EKPA_CC3W_G2FKKEOV60MKUASXUNAGKQTDG2W1DIUZGMTV1OAGRXFKIMNRC2FB10E1UNAQM1FKC5POAXFV1FSCGQWCGBI_PEPVCIMSUF3P6AWR6GTKCZ7GFU0GK5PCF_OSY2PDJUJUYBIWTYFAUEIOWI2L1E3GU3OVGDJ3FEOSPUO_VCWV6A0DC3IXU0K6QUTCK_JGMV03_MIXNUNSYAPENEHWIU0DJYWOU3SSCB03Q2JWLWTKQZ31J2E0EIXZKODGGIF5LA1CQUPVY1ZKYTKZCIIWCDXCCE3_YQM6PQWOLT0XGYPCNTAGAXBBOEKTYUY_UFIX3QWWLIUZK3W6N3UKY0MMBESOQIDBGMPSBIG6TMXR6E5ZGATKQRW6MCMC15MU6EIWLU0_1MIGQ30ZCBTAUYUGBUBB1RNWC2EKUA3K23K57UEKKZW7FU0WZCYSMUPSYAF5UQW1DINWTY32LMJ3SYMKGBE6RUOUGMXR15WWY2FYNQ67Y1ZKVUPOH5OGGITZQ6HRYRFKK7GKJM5ZCIPX1PNOUYOY1U31CZCZCITDT_GSYQUKV0ICJ2A6C2UKO_ISLB0SPX3A65WWYVFWNEPV6B0_17I562WC6A0S1SNS6BFB1UV2C3PGRXB51ZKCYEIWPM_RCXAGRXFKN_RSJG0FC5POSEPSC1TKYUPVYDB7QGVC12KALT03GE30BIUZGMQOLU7W620CWZW6R7J1GE32BQWAN5FB13Q5DQDW1AJCNTAGG1QWPQP56RMW1ZSVCMCSY3GKOCW7PUFC1URNUNQ7YQ0XGAW6R7BI1_PO1YOGQBFSNEE0R30DJY3SHZA5YAB5E5QOPG0_1FL0IAW_WAF2HE71U20SOARQU5DSYBB2NEC56ATKDK32BQW7PYD1NUJUYAUBGUQC1Z7G6A0_1XESYSM6UY32IEPVCIFST5DG6IUZQGWKHPWAL_O6YZW2JQODUME06EJ1RYDWFE5EY1FKY0IXUUWVCQSKVTAG7C_J1AJCNTAGJYUDNQWCM7MV1UQYHSW7FU0CVMHYQIB5FMK0IAWT61J2KMNGUYUZ1FLOUOKALBMWU3WWLTFCEDML1NHSYVPBO3W1DIUZGMMXMQ67QIB5FEBZGUTKV0IXUUWTCUMKVTAGN7FCG7GOU_BGRXFKCXIWEXUI1ILYURK5KUEKW3WWLII_UMS6HEE_6WFKCZ7GRXFKDDIKNTW1DIUZC5WALYWWTEEVUXKBCIXZKODG7UBBUMEX5EOAQBB_P3WAQIBC11XC7XKORA0ST_Q0BIVC11RC1ZWSRUS5K5UGMV0TN1W1UMJRYBIWPEIEYVS_G7HCQTA0YTBBMZA6QIPFGDWZLQ3RQINI1QUSQIB5FMLO17A0YQOV1Q35RX0CGYQCN_WRUUM21UJGKG0CQGPC1Z7G6RT6TNWWRA07QII0UXEYCIUZGEB1P106HMEC2QH1TUEKOUO7PUTC1FLOHEEGMVUWPEPVG2LKY1XRUXK0EYOY1_DGU3V2FMMC3_QZBIEWUONW7U0DJYWOUOK0AUQDK_J6YSPENX3SG0NSQA0ER_JGNQQWTMEVFEPV6B0_UEHWTYOY1ESC76HZYQOV1A35KIX_V0MXUYAGRXBD1UPGKYHZVMFOU5DSY1JBT_NGMV03_MWYOXWOQINI13KAJIJC1FLOUYE5P3SKQRW7FU0_PZMXC5AGE3EKQEIEYVS_G7HCUNQ7YYUKK3W7M303WWLC7_NGKG0CV2A0EBIK1131CZGGS2EWTEPVCIXWK_L2U_BGRXFKU0HSLTPETMSPU5DSQU0FK3E1LA0KOU1CWHWGGIL5QAW0MB0GJYXR62W6M1FKFQ6SGBGENMWZC2E7QIISWZPGRXJC1ETYNEK5YEIWVTA5YYUKDY32BQWC67NKEQHSQBJSNMJKHOUGG203_EKCLIIWCDXCQTEQFINSMQOGCDFB_FLSHSWOP3V5FEISYAFWOMPSEQW267BVK3AGG20XTAR2U_BGRXFKJ_Q6CIJC1U3PI6J76YOK1MWTMCODC1RCN_WCFYDZ1UWOKIC6W7HC2CWOYSISTYWZG_FKOYP3MUJOYQOV1TA5YAJCVYV1UPA6AUOVKZCG6IHWPFPOU3H1NU0IQ6WQM1FKVA3KHE35AX0GJQNSYAP3GMX66ZPEYAUWR3WZMEFB1XS6HESORUSKQRW7FU0UNYE063PGA7ZCVMHGECTZGE3PL_IGRXFKOMNPJU0BQWOCNTAGLQSBQAWC60MKY0MMBEA0A0PCG3WWRIBTQHICNTAGRQM215NSCA0GJ1GRUQJQG7D2GEPVCIT7QF3KHPW7FU0UQ_H0CATKQZ32BQW2JQDW1UP6C0GK1YZOLCPVG2HKKYLOPBTKCMTV6MOOLB0TW5W6SRM_OY3SG0NSQAJ6PEJ1RIBKFU1CJMO6CA06PESVGSIKKMHYUZK7YAQWPPWOLII6WD32BQNSYBIW1CKALW03C1HOH3WQM1FKH2K_YBIW1FS6HEP1YVFDETWC6BFB1MMXH_6SLB0SPPW0CSFCUUVAUQI2J3Z3GZPG62EKHAVW62HEYBIW1_6QS5BDKARCIRW7FU0VC6CVRUSC1AJCEUJUQIBC1UW76_FKOK3063PGRXFBGEPVCIJVGU3Y7EPVCIP2FELOR7JSTWLKFEHWDU0_UE3C6_F5GX3KL_Q0BINW1UW6CU0DJYQCI6NGM0EKCZ6SQBPBUMLYQEPVCG0XQ2ISBIUZG1VC72ESLTTZK0OG62EKEAR2LM67CT0SNXEOLSFC1UXCNTAGD3V5VME0YAJVGMEX5EEGDUF21TKCYVPEPFESH3WOLT0CV2AOKA0GGDICA635BUEKDCWPC2FXKWIXNEO2G7JDUEDSYEI611WC1EO7PQOYG2W7MIUZGEICMQJ66BJ6P3WV6A05GHI0U2AOJ0ZKGZF1WUEKEASVU2A2MAFKC5W7FU0CKXICIRWOYVPEP53WLIBXVYVCNTAGDQU_I6AGMV0S1IIKLCW6S1NWTE7OWI03CK3EYEWEMC0SUWWWDIZ6WMWR1XHGQUOV1YAG73P1UMQAUPAOPIGBKQJRYY0TGEIO3TWEMC0XQ2W7FU02QHICIRWUMT0BGXESTU03GMJ0IYW6SSIKCEU1IU0_17IO5EJ1Y1PBGEP1YRFKIGMN6PWOEYUSVQ7GFUBDGX3WSEDS67UKHQN_C2UC1EYP7U6WC2U2_EKTYYUCG5JCCESOLB0CV23WLA0DQMP3FXW_CIB5FEEGDYOV1FLOGEP1Y5FBHQ67G3OKK73WSED1KUSKQRPSLIE61131N2EBCIU61MHZ6G0DJY3LO2JWLW0XG7A5Y3GKOK3LF_KRYQOV1CKAYXBFGMROPQNGUYU5G3OSBIB5_FLSHSW6MIV5U5AOBG0CQMYX3QN76YOKC3W_WIIWCDXC26PGLUFV1UWQM2GWUE32BUOGR30IQ6W_WIEWCD3PLUA0BIXZQEDOTU0CQMSPNQJGC2EETQ7GRXFKC7K3C3DGMV0GK5JSQAJ5IMQAU3QRBUOKV230QYU_Q7WC72K_YAPBT_SGR30_O6SN6237CIK6_E30BIGBQ631QQA7Y1F2CZ6VM0ZKVA35C_HSLB07C3OWM2TKKMX06MPGKG07Q_NGFUBBVMPSEQWOYAJUME6VG0EKC7HCA237GVZKK5OGCDFB_MJKHOUGB305Q5W_C2U_Q732BUOG6WB_PEPVC7FKCDICJQK2JU0GJ_WCMCMV1WIXM6NSY1FKH_NGGB0KOU1CWJWGRXFKE_I_M207GATV6EKTYBIW10HOAU01PA_CGQWOJ7FSFCWOLT02QHICGQW267U_E6HOP0ZKV0IC3TEZB7F51ADSLIBD1ZM0M5WWYQTCQOEORUEKY1XRU5DSKIB5FEE0OCJBGX3SHE3GD7JWPPHEYBP5GMELI6PGRXF_TEROPYPEUMX0CRHSQIT6OQWT62D_GX32BMPGGIX_UTARYBPKT1HS36HSYBIWOE30BIUET7INURN1KINW1UJGCFDWGXMXAEEZJIIEO_Q5YY0VKX3XI5WOJ0PG15DORID_TWYWM530AU0DQEC5GUWW16ICCEK0JG0XGXPGK3TD13IOHXUGUXBD1UWV6DFKQZXOHE5SD3SW1_56C7WWFMTOL3K0QIXZQE6OLID2C1QC1E6SPBB_PENOL_01GYTCNTA_QUMFG3WQM0E2_MEVI_BGD7P315DSYSP3OARCJQK2JU0SUEPVMCHZ1FLOSEBS67FV15KGJ3TW1FLOC2WWK5PBVMJQCICI1FLOUOK0RQDD1ADWJAUKYUR2IZWWB0FBUE30BITEE03KME35CIQBQZAGR30TCX3TIWE0EIBXHQ67YBPKFYWM6Z7GR30DJQE5Y0FFG53YHXUGR303CWAGRXFKRAS0U0A1N0FKHQAZYBIWKD3SG0A5RYOWPOAG60MKV0ICG_NSY_FWPXUGYY01PA_CPQNEYEF2NEPV6B0GGME06EJ1RIB2NEA3SQMKPAVC3MJG7U0CQE5ARIJD11WCGCW1NYO_QZW7FQUKJY36B_WOT3JVUEPVCID6O6SXU0A1N0FKKZW1PTFB17S2U5KGJ3TW15DSG70BGETO35WWQIBC1YQQFIU61VPKGQWOQIBKE_SOPT0GJA3RCPA6YXJ3UQHTYVS6OMLSMEA0C1ZKDQ6OSAFKJY3P6MN6YTFXGMPGYBIW1AXR62WR6G0_1AA0RIU61FLOURKALBB_PE30BIG6W7HC1EU1S2HKUQNB62UKI1VVUAD1YXBV13A7YXFB1BM23TA5Y3OKVTAGJ3XWUF31NQLG62EKN_KYCT0STAYX5EP1YAFW1UBGM2FKQZ3R62WQM1QSPUK0QIXSUMEZJ2KOAXJ5IEP1Y5MSEY3SNEK0YXFB1TAOBIJKTURC5_S0YQOV1XK1IUEKCF3R62W6FQM21UWVC0QK_AYCJ2A7RG02C3OGQQJV1131BQWPJCTZGPWRCUQ2_MSRU3E5YAIW1QTQJQJ3GX3XIE6SPUN6PCWWY7F7N1INU3DSYQE0W3PSBIIWTMLO1PWUCQSKCZ7GGIIWNBINUTA5YAIW15DOL_FV16IC1Z7G6ADWPPARYBIW1EXOJ3WGKQZK3LWGGIISXY3W1PAG60MKU_N7QIPX1UG_OME0RQOUG3WPSB0ZCHIC13WECB0XQ6JRY2PKUAGS65UGGIL5QAW0MB0GJUXC15P56SU_QZWWY5PCUYW1URK5YBIW10A1N0FKUA3W1ZUGMV0DJQIGJYLW16IC1Z7G6BUSETW7FUNCG5ZOMEP1Y1FKCZ7GRXF5113P6QHGQ3SB_ESVC20DJY30IM7GUU07W2OACIU6IYXR62WUMUTKQZHEYQ0CJAV2UPE6RQOUGEETYGPE11R_OUNSYEISVEPVCIQWQBPOUMNSY0J1GEDSPU0_16Y1NE30QEFB15DSYAB3GME1UQRSPGXZG2AGRXFKJGQKHENOAU0_UE5ARIBKOARYN_J1SA0SHR3WPIN6UF3Y7EPVC102CNKAPIUZGMK06MPSPIQST5W1DIUZG1VCNUISYVPB1YA5CITEDEM1NQJQCIB5FEPVCITUC7XAU0K5RYP51_BGD7FWFAQCQTEQFISWOME0QIU61FLOGEO1YBS6WNHSQIUZG632BMPGRXFI16OSYUWWTK3ORQN7G3OKV_WUCB0BKX3Y7EE7Y3IKVTAGBUTDK71CIRW_620KD6PGRXFI1UVOUMW5GWID1SK1BIT6TF3Y7ELSM5MW1UBGGIPUEUWSIZ3ZJG0XQ2CSRINIUYPPUMJRYBB1GELOPB0_PMXR6EE0L3DWP5W2JUBCWDI1UADWAX0STQW0MB0IGF3PI25WBTF515KGRXFKRYE11ZP5WIB5FEA0H3ZKOKWOFRWTM70_P3POLSFKY1XRUSA0SYOW1RNSCTP31URNU3E0AUS_VCW5MCOV1U366XHGA3WWTQ7GRQC2GMS0UMN562HW1MJGCFDETEMYHEK5YQ0VCZ6SY3Q7QDX3HQHEYQOV13KGD3SDJMEVFEPVGA07T_7AAUTKCMKYIPWSDVFUVEQ2M203_MHSM0K6GBJ6PEK0JG0_16Y1NEB1PWFD15DORIUZGDICFUAGB3S3CZPGUYUZK73W6EO1Y1B5_EK7FUSKSGEVC5ESQIXZKODGK3V2FYVCO3AZCAT2_E30BIXZKWLCCE3_Y3C2KSARYBPKMYIZUO35CVV2NCWQM2DWC5INUMDGRXJC15D1SWID1UJP6OP6Y1ZKU0E5GBTKHYE076HZWIB5FEUSRIU61VICGUOALTFBU5K1BIJC1FLOUR37CIPX15DSY0J1GMSPU6OGYQMSUEPV6B0DJY3PLUA0BIPX1YUGW3VDJMM1USK0CIB2C3W7FQUKKMI562WYLUXKJQNGGIN_I0XCMMUGR303_3AZDIZ6WME06E3GB7FSOQNGR30CGYOCQT37YYTKP_PGR30TGMJYOZ7GFUSW1NAZME0TWF31BQWV6A0TGQJGKYOW113R17AGN3TCG3OSBIUZCF3R6MN7YBISVEJ170FKUAYVUUJGUXPCGEL5CAF5EY3SU3ASKUEKV_WPCIN6TY32BMJGGISWCXHEYEBC1VIM16OSYY0GC3WOJ00DJUXCCE61S0EKDQWUM3EKJYE56ZOGBYEKVTA0YQ0CK7KV6EL1UUSKQRW_WIT6W5306Y3WLIV5GBA5AYTWFMMXUTA5Y5SWUQJQCID6W5HCCEJ1RIE_U0HOWIU611X1URQZJIFHVQJ7YBISVMQAM5A5G3VC1RASJYOY1IM2BESVGSIKOCWVCQSD1YQLLM6SQIOSV6NSYEBC17S2U_Q5YYODG261S7TW1U3Z62LSRCB21AAPY3GKV0IC7UJSQB0WO_PWM2TKQZ32BQWYCUOWU5WCGB0DJY3512ESRYFC1_BGUXJUJMI56ZWWLIUZGUNGTUSI1YGM6ZP5GSJD_E51PU0DJY31NMI2Y3GKIQJWSA0SNUWCNTAGDUXK_Q35QICI1ILS3TW6FU0GC3W_WITWP1S0UNN1SWID1TA5YBPKV0ICA23BCICWH_NSY1FKPYZOLE6OLIJKH_NUCB0ZGD3PC2IGKYOV1_NGFUSKJYE56ZHEY5BDKQJQCI0S1ZI6UP3EQIBYQEEGKUUKCMGOL53WLIZ6WZCGTI0KCMJ01ZGGM5F51RAZJ3XKY1XRUMW_MAUKRXAOQYOY1WS3H5A062DW1TAGFQTKLGW2UXATRIUZGEQ0GDFBU1XAUPKSQIO6VE7SC10ZK6WOFRW1TUSGK3AG7CUKDYPS67A6YXFKMZKCQIN6TY32BMJGMBIWTELSM5MW10ICBMOGU3S1GPWV67EKCE3SUO30Y5FBE"


alphabet_string = "0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_"
CHARS = []
for ch in alphabet_string:
    CHARS.append(ch)
chars_to_num = {}
num_to_char = {}
for i in range(len(CHARS)):
    chars_to_num[CHARS[i]]=i
    num_to_char[i] = CHARS[i]

for x in range(1,21):
    total_freq = [0]*37
    for k in range(1):
        CIPHER = CIPHER_BASE[k::x]
        freq1 = {}
        for char in CIPHER:
            if char in freq1.keys():
                freq1[char] += 1
            else:
                freq1[char] = 1
        print(freq1)
        freq1_list=sorted(freq1.items(),key=itemgetter(1))
        freq1_list_bis = [[],[]]
        for elem in freq1_list:
            freq1_list_bis[0].append(elem[0])
            freq1_list_bis[1].append(elem[1])
        for i in range(len(freq1_list_bis[0])):
            total_freq[i] += freq1_list_bis[1][-(i+1)]
    
        k_p = 0.067
        k_r = 1./37.
    
        k_0 = 0
        for i in range(len(freq1_list)):
            k_0 += freq1_list[i][1] * (freq1_list[i][1]-1)
        k_0 /= (len(CIPHER) * (len(CIPHER)-1))
        est_key = (k_p - k_r)/(k_0-k_r)
        print (est_key)     #around 7
    plt.figure()
    plt.bar(range(len(freq1)),freq1_list_bis[1],align='center')
    plt.xticks(range(len(freq1)),freq1_list_bis[0])
    #plt.figure()
    #plt.bar(range(37),total_freq,align='center')
    plt.title(str(x))
    plt.show()
    diff = (chars_to_num['_'] - chars_to_num[freq1_list_bis[0][-1]]) % 37
    diff_bis = (chars_to_num['E'] - chars_to_num[freq1_list_bis[0][-2]]) % 37
    print(diff,diff_bis)